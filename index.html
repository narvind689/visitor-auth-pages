<script>
  // =================================================================
  // ğŸš¦ SMART ROUTER (STRICT MODE)
  // =================================================================
  (function() {
    const params = new URLSearchParams(window.location.search);
    const hashParams = new URLSearchParams(window.location.hash.substring(1));
    
    const type = params.get('type') || hashParams.get('type');

    console.log('ğŸš¦ Authentication Flow Router');
    console.log('ğŸ“ URL:', window.location.href);
    console.log('ğŸ“ Type:', type);
    console.log('ğŸ“ Query params:', Object.fromEntries(params.entries()));
    console.log('ğŸ“ Hash params:', Object.fromEntries(hashParams.entries()));

    // ================================
    // Strict routing based on type
    // ================================
    if (type === 'signup' || type === 'email' || type === 'email_change') {
      console.log('âœ… Email verification flow â†’ verify-email.html');
      window.location.replace('verify-email.html' + window.location.search + window.location.hash);
    } 
    else if (type === 'recovery') {
      console.log('âœ… Password recovery flow â†’ reset-password.html');
      window.location.replace('reset-password.html' + window.location.search + window.location.hash);
    }
    else {
      // No valid type â†’ invalid link
      console.log('âŒ Invalid or expired link (missing type)');
      document.querySelector('h2').textContent = 'Invalid or Expired Link';
      document.querySelector('p').textContent = 'This link is invalid, expired, or has already been used.';
      document.querySelector('.spinner').style.display = 'none';
    }
  })();
</script>
